<html>
<head>
	<title></title>
	<script src="js/vendor/d3.min.js" type="text/javascript"></script>
	<script type="text/javascript" src="js/vendor/jquery-2.1.4.min.js"></script>
	<script type="text/javascript" src="js/vendor/jquery-ui.min.js"></script>
	<link rel="stylesheet" href="css/vendor/jquery-ui.min.css">
	<link rel="stylesheet" href="styles.css">
</head>
<script src="https://cdn.firebase.com/js/client/2.4.2/firebase.js"></script>
<script type="text/javascript" src='stateCheck.js'></script>
<script type="text/javascript" src='visDrawer.js'></script>
<script type="text/javascript" src='showVis.js'></script>
	
	<script src="https://www.gstatic.com/firebasejs/5.8.6/firebase.js"></script>

<script type="text/javascript">
	
	var config = {
	  apiKey: "AIzaSyCDvpYTQwRRPDmC-w3Quq5nSMmwruYQSt0",
	  authDomain: "hierarchical-269d0.firebaseapp.com",
	  databaseURL: "https://hierarchical-269d0.firebaseio.com",
	  projectId: "hierarchical-269d0",
	  storageBucket: "hierarchical-269d0.appspot.com",
	  messagingSenderId: "754209883401"
	};
	firebase.initializeApp(config);
	var stream0 = "";
	var stream1 = "";
	var stream2 = "";
	var stream3="";
	var stream4="";

function writeUserData(userId, stream0) {
  firebase.database().ref('users/' + userId).set({
    username: userId,
    bio: stream0
  });
}
      // Method
     function calcList() {
        var finalList=[];
        var array=[];
        for (var i=0; i<dict.length;i++){
            array[i]=i;
        }
        var i = array.length,
            j = 0,
            temp;

        while (i--) {

            j = Math.floor(Math.random() * (i+1));

            // swap randomly chosen element with current element
            temp = array[i];
            array[i] = array[j];
            array[j] = temp;

        }
        var listnum=0;
        var indx=0;
        var ind=0;
        do {
        	
           if (dict[array[indx]].remaining>0){
                finalList[ind]=dict[array[indx]].experimentID;
                dict[array[indx]].remaining--;
                if (indx==26)
                    indx=0;
                else
                    indx++;
                listnum++;
                ind++;
            }else{
                if (indx==26)
                    indx=0;
                else
                    indx++;

            } 

        }while(listnum<27)
        return finalList;

      }



var comparisonSets = [
			"Animation" ,
			"SidebySide",
			"Diff" 
		];
var visSets = [
			"tree",
			"treemap",
			"sunburst" 
		];
var changeSets = [
		"move" ,
		"add",
		"remove" 
	];
var dataSets = [
		"small"
	];		
var compState=0;
var visState=0;
var changeState=0;
var dataState=0;
var dict = []; // create an empty array
 for(var i=0; i<3;i++){
       	 for (var ii=0; ii<3;ii++){
	         for (var iii=0;iii<3;iii++){
	        		dict.push(
	        		  {
	        		      experimentID:""+comparisonSets[i]+","+visSets[ii]+","+changeSets[iii]+","+"small"+"DOT",
	        		      remaining: 100
	        		 
	        		  })
	        	
		         
	       }
       	}

   }
console.log(dict)
var userids=[];
var uindx=0;
var currentindex=0;
function showNextQ(){//call question
	//var prevQ = parseInt($('.indexKeeper').attr('id')); // get id of the submitting question
	//choose comparison type
	timestamp=new Date().getTime();
	
		if(currentindex == 0) // going to load 1st Q, store personal details from prev page
	{

		var count=0;
		stream0 += $('input:radio[name="age"]:checked').val();
		stream0 += "," + $('input:radio[name="sex"]:checked').val();
		stream0 += "," + $('input:radio[name="hours"]:checked').val()+",";


		$('input:checkbox').each(function () {
			if(this.checked)
			{
				if(count ==0) stream0 += $(this).val();
				else stream0 += "_" +$(this).val();

				count++;

			}
		});
		

	}


	userids[uindx++]=timestamp;
	writeUserData(timestamp, stream0)
	var personxlist=[];
	personxlist=calcList();
	console.log(dict)
	console.log(userids)
	//personxlist=["Animation,sunburst,move,smallDOT","Sidebyside,treemap,move,smallDOT","Animation,sunburst,remove,smallDOT","Diff,treemap,remove,smallDOT","Sidebyside,tree,remove,smallDOT","Animation,treemap,move,smallDOT","Diff,sunburst,remove,smallDOT","Sidebyside,treemap,remove,smallDOT","Diff,treemap,move,smallDOT","Animation,treemap,add,smallDOT","Sidebyside,tree,move,smallDOT","Sidebyside,sunburst,move,smallDOT","Animation,treemap,remove,smallDOT","Diff,sunburst,move,smallDOT","Diff,tree,add,smallDOT","Diff,treemap,add,smallDOT","Sidebyside,tree,add,smallDOT","Sidebyside,sunburst,add,smallDOT","Sidebyside,treemap,add,smallDOT","Animation,tree,add,small"]	
	var variables=personxlist[currentindex].split(",");
	//localStorage.myArrData=JSON.stringify(personX.list);
	var comparisonType = variables[0];
	console.log(comparisonType)
	console.log(personxlist)
	var queryString = "?para1=" + currentindex;
	window.location.href = comparisonType+".html" + queryString;
	//window.open(comparisonType+".html", "_self");
	 sessionStorage.setItem('myArray', personxlist);

}



</script>

<body>


	<div id="CONTAINER" >
		<div class="question" id="0"> <!-- This is considered as question 0 -->
			<span class="indexKeeper" id="0"></span>
			<p>
				<h2 style="text-align:center;" >Answer Questions</h2>
				<span style="font-size:130%;">
					The goal of this study is to measure the effect of different comparison techniques on different hierarchical data visualizations based on given parameters such as size of the hierarchy and type of change. In this experiment you will be asked to answer questions based on the change that you observe in screen.   </br></br>
				</span>
			
			</p>


			<tr>
				<td width=20 style="font-weight:bold;vertical-align:text-center;"> Age: </td></br>
				<td>
					<input type="radio" name="age" value="20-25" style="margin-right: 0" checked /> 20-25 years old
					<input type="radio" name="age" value="25-35"  style="margin-right: 0" />    25-35 years old</br>
					<input type="radio" name="age" value="34-45" style="margin-right: 0" />    35-45 years old
					<input type="radio" name="age" value="Above 45" style="margin-right: 0" />    Above 45 years old</br>
				</td>
			</tr> </br>

			<tr>
				<td width=20 style="font-weight:bold;vertical-align:text-center;">Sex:</td><br>
				<td>
					<input type="radio" name="sex" value="male" style="margin-right: 0" checked /> Male
					<input type="radio" name="sex" value="female"  style="margin-right: 0" /> Female </br>
				</td>
			</tr> </br>

			<tr>
				<td width=20 style="font-weight:bold;vertical-align:text-center;">Have you ever created a visualization before?</td> </br>
				<td>
					<input type="radio" name="hours" value="No" style="margin-right: 0" checked /> No
					<input type="radio" name="hours" value="Yes"  style="margin-right: 0" />  Yes </br>
				</td>
			</tr></br>

			<tr>
				<td width=20 style="font-weight:bold;vertical-align:text-center;"> Have you ever used any of the following tools or libraries to create a visualization? If so, which ones?  </td> </br>
				<td>
					<input type="checkbox" name="tool" value="Excel"> Microsoft Excel </br>
					<input type="checkbox" name="tool" value="Tableau"> Tableau </br>
					<input type="checkbox" name="tool" value="Spotfire"> Spotfire </br>
					<input type="checkbox" name="tool" value="D3"> D3</br>
					<input type="checkbox" name="tool" value="Processing"> Processing</br>
					<input type="checkbox" name="other" value="Other"> Other</br>
					<form class="others">
					</form>

				</td>
			</tr> </br>

			<!-- <ul>
			 
			  <li><a href="AnimationDisplay.html">Proceed</a></li>
			 
			</ul> -->
			<input type="submit" value="Start Session" onclick="showNextQ()" />


		</div>
	</div>
</body>
</html>
